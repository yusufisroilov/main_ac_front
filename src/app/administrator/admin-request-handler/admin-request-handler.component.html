<!-- Complete admin-request-handler.component.html -->
<div class="main-content">
    <div class="container-fluid">

        <!-- Page Header -->
        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header card-header-icon card-header-primary">
                        <div class="card-icon">
                            <i class="material-icons">assignment</i>
                        </div>
                        <h4 class="card-title">Yetkazish So'rovlari</h4>
                        <p class="card-category">Mijozlardan kelgan yetkazish so'rovlarini boshqarish</p>
                    </div>
                    <div class="card-body">

                        <!-- Filters -->
                        <div class="row mb-3">
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="bmd-label-floating">Yetkazish Turi</label>
                                    <select class="form-control" [(ngModel)]="filterDeliveryType">
                                        <option value="">Barchasi</option>
                                        <option value="EMU">EMU Post</option>
                                        <option value="Yandex">Yandex</option>
                                        <option value="Own-Courier">Kuryer</option>
                                        <option value="Pick-up">Olib ketish</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="bmd-label-floating">Shoshilinch</label>
                                    <select class="form-control" [(ngModel)]="filterUrgent">
                                        <option value="">Barchasi</option>
                                        <option value="true">Shoshilinch</option>
                                        <option value="false">Oddiy</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="bmd-label-floating">Mijoz ID</label>
                                    <input type="text" class="form-control" [(ngModel)]="filterCustomerId"
                                        placeholder="Mijoz ID kiriting">
                                </div>
                            </div>

                            <div class="col-md-3">
                                <div class="form-group">
                                    <label>&nbsp;</label>
                                    <div>
                                        <button class="btn btn-primary mr-2" (click)="applyFilters()"
                                            [disabled]="loadingRequests">
                                            <i class="material-icons">search</i>
                                            Qidirish
                                        </button>

                                        <button class="btn btn-secondary" (click)="clearFilters()">
                                            <i class="material-icons">clear</i>
                                            Tozalash
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- View Toggle Buttons -->
                        <div class="row mb-3">
                            <div class="col-md-12">
                                <button class="btn btn-info mr-2" [class.btn-primary]="!showArchiveTable"
                                    [class.btn-outline-primary]="showArchiveTable" (click)="showPendingTableView()">
                                    <i class="material-icons">schedule</i>
                                    Kutilayotgan So'rovlar
                                </button>

                                <button class="btn btn-info mr-2" [class.btn-primary]="showArchiveTable"
                                    [class.btn-outline-primary]="!showArchiveTable" (click)="showArchiveTableView()">
                                    <i class="material-icons">archive</i>
                                    So'rovlar Arxiv
                                </button>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>

        <!-- Archive Requests Table -->
        <div class="row" *ngIf="showArchiveTable">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header card-header-info">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h4 class="card-title mb-1">Arxiv So'rovlar</h4>
                                <p class="card-category mb-0">
                                    <span *ngIf="totalArchiveRequests > 0">{{totalArchiveRequests}} ta arxiv so'rov
                                        bor</span>
                                    <span *ngIf="totalArchiveRequests === 0">Hozircha arxiv so'rov yo'q</span>
                                </p>
                            </div>
                            <div>
                                <button class="btn btn-sm btn-outline-light" (click)="loadArchivedRequests()"
                                    [disabled]="loadingRequests" title="So'rovlarni yangilash">
                                    <i class="material-icons" *ngIf="!loadingRequests">refresh</i>
                                    <i class="fa fa-spinner fa-spin" *ngIf="loadingRequests"></i>
                                    <span class="d-none d-md-inline ml-1">Yangilash</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">

                        <!-- Loading indicator -->
                        <div *ngIf="loadingRequests" class="text-center p-4">
                            <div class="spinner-border text-primary" role="status">
                                <span class="sr-only">Yuklanmoqda...</span>
                            </div>
                            <p class="mt-2">So'rovlar yuklanmoqda...</p>
                        </div>

                        <!-- Archive Requests table -->
                        <div *ngIf="!loadingRequests && archivedRequets.length > 0">
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead class="text-primary">
                                        <tr>
                                            <th>No</th>
                                            <th>Mijoz ID</th>
                                            <th>Telefon</th>
                                            <th>Yetkazish turi</th>
                                            <th>Qutillar</th>
                                            <th>Holat</th>
                                            <th>Vaqt</th>
                                            <th>Amallar</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let request of archivedRequets; let i = index"
                                            [class.table-warning]="request.is_urgent">
                                            <td>{{i + 1}}</td>
                                            <td>
                                                {{request.owner_id}}
                                                <span *ngIf="request.is_urgent"
                                                    class="badge badge-danger ml-1">Shoshilinch</span>
                                            </td>
                                            <td>{{request.customer_phone}}</td>
                                            <td>{{getDeliveryTypeText(request.delivery_type)}}</td>
                                            <td>{{request.total_packages}} ta</td>
                                            <td>
                                                <span class="badge"
                                                    [class.badge-success]="request.status === 'approved'"
                                                    [class.badge-danger]="request.status === 'rejected'"
                                                    [class.badge-secondary]="request.status === 'cancelled'">
                                                    {{getStatusText(request.status)}}
                                                </span>
                                            </td>
                                            <td>{{request.created_at | date:'short'}}</td>
                                            <td>
                                                <button class="btn btn-sm btn-info"
                                                    (click)="viewRequestDetails(request.id)">
                                                    Ko'rish
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- No archived requests message -->
                        <div *ngIf="!loadingRequests && archivedRequets.length === 0" class="text-center p-4">
                            <i class="material-icons" style="font-size: 48px; color: #ccc;">archive</i>
                            <h5 class="mt-2">Arxiv so'rov yo'q</h5>
                            <p class="text-muted">Hozircha arxivlangan yetkazish so'rovlari mavjud emas</p>
                        </div>

                    </div>
                </div>
            </div>
        </div>

        <!-- Pending Requests Table -->
        <div class="row" *ngIf="!showArchiveTable">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header card-header-info">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h4 class="card-title mb-1">Kutilayotgan So'rovlar</h4>
                                <p class="card-category mb-0">
                                    <span *ngIf="totalRequests > 0">{{totalRequests}} ta so'rov kutilmoqda</span>
                                    <span *ngIf="totalRequests === 0">Hozircha yangi so'rov yo'q</span>
                                </p>
                            </div>
                            <div>
                                <button class="btn btn-sm btn-outline-light" (click)="loadPendingRequests()"
                                    [disabled]="loadingRequests" title="So'rovlarni yangilash">
                                    <i class="material-icons" *ngIf="!loadingRequests">refresh</i>
                                    <i class="fa fa-spinner fa-spin" *ngIf="loadingRequests"></i>
                                    <span class="d-none d-md-inline ml-1">Yangilash</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">

                        <!-- Loading indicator -->
                        <div *ngIf="loadingRequests" class="text-center p-4">
                            <div class="spinner-border text-primary" role="status">
                                <span class="sr-only">Yuklanmoqda...</span>
                            </div>
                            <p class="mt-2">So'rovlar yuklanmoqda...</p>
                        </div>

                        <!-- Pending Requests table -->
                        <div *ngIf="!loadingRequests && pendingRequests.length > 0">
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead class="text-primary">
                                        <tr>
                                            <th>No</th>
                                            <th>Mijoz ID</th>
                                            <th>Telefon</th>
                                            <th>Yetkazish turi</th>
                                            <th>Qutillar</th>
                                            <th>Holat</th>
                                            <th>Vaqt</th>
                                            <th>Amallar</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let request of pendingRequests; let i = index"
                                            [class.table-warning]="request.is_urgent">
                                            <td>{{i + 1}}</td>
                                            <td>
                                                {{request.owner_id}}
                                                <span *ngIf="request.is_urgent"
                                                    class="badge badge-danger ml-1">Shoshilinch</span>
                                            </td>
                                            <td>{{request.customer_phone}}</td>
                                            <td>{{getDeliveryTypeText(request.delivery_type)}}</td>
                                            <td>{{request.total_packages}} ta</td>
                                            <td>
                                                <span
                                                    class="badge badge-warning">{{getStatusText(request.status)}}</span>
                                            </td>
                                            <td>{{request.created_at | date:'short'}}</td>
                                            <td>
                                                <button class="btn btn-sm btn-info mr-1"
                                                    (click)="viewRequestDetails(request.id)">
                                                    Ko'rish
                                                </button>
                                                <button class="btn btn-sm btn-success mr-1"
                                                    (click)="showApprovalFormForRequest(request.id)"
                                                    *ngIf="request.status === 'pending'">
                                                    Tasdiqlash
                                                </button>
                                                <button class="btn btn-sm btn-danger"
                                                    (click)="showRejectionFormForRequest(request.id)"
                                                    *ngIf="request.status === 'pending'">
                                                    Rad etish
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- No pending requests message -->
                        <div *ngIf="!loadingRequests && pendingRequests.length === 0" class="text-center p-4">
                            <i class="material-icons" style="font-size: 48px; color: #ccc;">assignment_late</i>
                            <h5 class="mt-2">Kutilayotgan so'rov yo'q</h5>
                            <p class="text-muted">Hozircha kutilayotgan yetkazish so'rovlari mavjud emas</p>
                        </div>

                    </div>
                </div>
            </div>
        </div>

    </div>
</div>

<!-- Request Details Modal -->
<div class="modal" [class.show]="showRequestDetails" [style.display]="showRequestDetails ? 'block' : 'none'"
    style="z-index: 1050;" *ngIf="showRequestDetails">
    <div class="modal-dialog modal-xl" style="max-height: 80vh; margin-top: 5vh;">
        <div class="modal-content" style="height: 85vh; display: flex; flex-direction: column;">
            <div class="modal-header" style="flex-shrink: 0;">
                <h5 class="modal-title">So'rov Tafsilotlari - #{{selectedRequest?.id}}</h5>
                <button type="button" class="close" (click)="closeModal()">
                    <span>&times;</span>
                </button>
            </div>
            <div class="modal-body" style="flex: 1; overflow-y: auto; padding: 20px;" *ngIf="selectedRequest">

                <!-- Request Info -->
                <div class="row mb-4">
                    <div class="col-md-6">
                        <h6>Mijoz Ma'lumotlari</h6>
                        <p><strong>Mijoz ID:</strong> {{selectedRequest.owner_id}}</p>
                        <p><strong>Telefon:</strong> {{selectedRequest.customer_phone}}</p>
                        <p><strong>Yetkazish turi:</strong> {{getDeliveryTypeText(selectedRequest.delivery_type)}}</p>
                        <p *ngIf="selectedRequest.is_urgent" class="text-danger">
                            <strong><i class="material-icons">priority_high</i> Shoshilinch yetkazish</strong>
                        </p>
                    </div>

                    <div class="col-md-6">
                        <h6>Yetkazish Ma'lumotlari</h6>
                        <p><strong>Jami qutillar:</strong> {{selectedRequest.total_packages}} ta</p>
                        <p *ngIf="selectedRequest.delivery_address">
                            <strong>Manzil:</strong> {{selectedRequest.delivery_address}}
                        </p>
                        <p *ngIf="selectedRequest.emu_branch_id">
                            <strong>Filialimiz:</strong> {{loadBranchByid(selectedRequest.emu_branch_id)}}
                        </p>
                    </div>
                </div>

                <!-- Payment Information Section -->
                <div class="row mb-4" *ngIf="selectedRequest.payment_amount || paymentImageUrls.length > 0">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header" [class.card-header-success]="selectedRequest.payment_verified"
                                [class.card-header-warning]="!selectedRequest.payment_verified">
                                <h6 class="card-title">
                                    <i class="material-icons">payment</i>
                                    To'lov Ma'lumotlari
                                    <span class="badge badge-success ml-2"
                                        *ngIf="selectedRequest.payment_verified">Tasdiqlangan</span>
                                    <span class="badge badge-warning ml-2"
                                        *ngIf="!selectedRequest.payment_verified">Kutilmoqda</span>
                                </h6>
                            </div>
                            <div class="card-body">
                                <!-- Payment Amount -->
                                <div class="row mb-3" *ngIf="selectedRequest.payment_amount">
                                    <div class="col-md-4">
                                        <p><strong>To'lov Miqdori:</strong></p>
                                        <h5 class="text-success">{{selectedRequest.payment_amount | number:'1.0-0'}} UZS
                                        </h5>
                                    </div>

                                    <div class="col-md-4" *ngIf="selectedRequest.payment_verified">
                                        <p><strong>Tasdiqlash Holati:</strong></p>
                                        <span class="badge badge-success">
                                            <i class="material-icons">check_circle</i> Tasdiqlangan
                                        </span>
                                    </div>

                                    <div class="col-md-4" *ngIf="selectedRequest.payment_notes">
                                        <p><strong>Admin Izohi:</strong></p>
                                        <small class="text-muted">{{selectedRequest.payment_notes}}</small>
                                    </div>
                                </div>

                                <!-- Payment Images -->
                                <div class="row mb-3" *ngIf="paymentImageUrls && paymentImageUrls.length > 0">
                                    <div class="col-md-12">
                                        <h6>To'lov Rasmlari ({{paymentImageUrls.length}} ta):</h6>
                                        <div class="row">
                                            <div class="col-md-3 mb-3"
                                                *ngFor="let imageUrl of paymentImageUrls; let i = index">
                                                <div class="card">
                                                    <img [src]="imageUrl" class="card-img-top"
                                                        style="height: 150px; object-fit: cover; cursor: pointer;"
                                                        (click)="showFullImage(imageUrl, i)"
                                                        [alt]="'To\'lov rasmi ' + (i + 1)"
                                                        onerror="this.src='assets/img/placeholder.png'">
                                                    <div class="card-body p-2">
                                                        <small class="text-muted">Rasm {{i + 1}}</small>
                                                        <button class="btn btn-sm btn-info float-right"
                                                            (click)="showFullImage(imageUrl, i)"
                                                            title="Katta ko'rinishda ko'rish">
                                                            <i class="material-icons">zoom_in</i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- No payment images message -->
                                <div class="row mb-3" *ngIf="!paymentImageUrls || paymentImageUrls.length === 0">
                                    <div class="col-md-12">
                                        <div class="alert alert-info">
                                            <i class="material-icons">info</i>
                                            Mijoz tomonidan to'lov rasmi yuklanmagan
                                        </div>
                                    </div>
                                </div>

                                <!-- Payment Verification Actions -->
                                <div class="row"
                                    *ngIf="!selectedRequest.payment_verified && selectedRequest.status === 'pending'">
                                    <div class="col-md-12">
                                        <div class="form-group">
                                            <label>To'lovni tasdiqlash:</label>
                                            <div class="btn-group">
                                                <button class="btn btn-success" (click)="verifyPayment(true)">
                                                    <i class="material-icons">check</i> To'lov To'g'ri
                                                </button>
                                                <button class="btn btn-warning" (click)="showPaymentNotesForm()">
                                                    <i class="material-icons">note</i> Izoh Qo'shish
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Customer Notes -->
                <div class="row mb-4" *ngIf="selectedRequest.notes">
                    <div class="col-md-12">
                        <h6>Mijoz Izohi</h6>
                        <p class="alert alert-info">{{selectedRequest.notes}}</p>
                    </div>
                </div>

                <!-- Packages Table -->
                <div class="row">
                    <div class="col-md-12">
                        <h6>Qutillar Ro'yxati</h6>
                        <div class="table-responsive" *ngIf="requestPackages.length > 0">
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>Barcode</th>
                                        <th>Partiya</th>
                                        <th>Mahsulotlar</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let pkg of requestPackages">
                                        <td>{{pkg.barcode}}</td>
                                        <td>{{pkg.consignment_name}}</td>
                                        <td>{{pkg.items_count || 0}}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

            </div>
            <div class="modal-footer" style="flex-shrink: 0;">
                <button type="button" class="btn btn-secondary" (click)="closeModal()">Yopish</button>
                <button type="button" class="btn btn-success mr-2"
                    (click)="showApprovalFormForRequest(selectedRequest.id)"
                    *ngIf="selectedRequest.status === 'pending'">
                    Tasdiqlash
                </button>
                <button type="button" class="btn btn-danger" (click)="showRejectionFormForRequest(selectedRequest.id)"
                    *ngIf="selectedRequest.status === 'pending'">
                    Rad etish
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Full Image Modal -->
<div class="modal" [class.show]="showFullImageModal" [style.display]="showFullImageModal ? 'block' : 'none'"
    style="z-index: 1060;" *ngIf="showFullImageModal">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">To'lov Rasmi {{currentImageIndex + 1}}</h5>
                <button type="button" class="close" (click)="closeFullImageModal()">
                    <span>&times;</span>
                </button>
            </div>
            <div class="modal-body text-center">
                <img [src]="currentFullImageUrl" class="img-fluid" style="max-height: 70vh; width: auto;"
                    [alt]="'To\'lov rasmi ' + (currentImageIndex + 1)" onerror="this.src='assets/img/placeholder.png'">
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" (click)="previousImage()"
                    [disabled]="currentImageIndex === 0 || paymentImageUrls.length <= 1">
                    <i class="material-icons">navigate_before</i> Oldingi
                </button>
                <button type="button" class="btn btn-secondary" (click)="nextImage()"
                    [disabled]="currentImageIndex === paymentImageUrls.length - 1 || paymentImageUrls.length <= 1">
                    Keyingi <i class="material-icons">navigate_next</i>
                </button>
                <button type="button" class="btn btn-primary" (click)="closeFullImageModal()">Yopish</button>
            </div>
        </div>
    </div>
</div>

<!-- Approval Form Modal -->
<div class="modal" [class.show]="showApprovalForm" [style.display]="showApprovalForm ? 'block' : 'none'"
    style="z-index: 1050;" *ngIf="showApprovalForm">
    <div class="modal-dialog modal-lg" style="max-height: 90vh; margin-top: 5vh;">
        <div class="modal-content" style="height: 80vh; display: flex; flex-direction: column;">
            <div class="modal-header" style="flex-shrink: 0;">
                <h5 class="modal-title">So'rovni Tasdiqlash - Mijoz: {{selectedRequest?.owner_id}}</h5>
                <button type="button" class="close" (click)="closeModal()">
                    <span>&times;</span>
                </button>
            </div>
            <div class="modal-body" style="flex: 1; overflow-y: auto; padding: 20px;" *ngIf="selectedRequest">

                <form>
                    <div class="row">
                        <!-- Delivery Fee -->
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="bmd-label-floating">Yetkazish To'lovi (UZS)</label>
                                <input type="number" class="form-control" [(ngModel)]="deliveryFee" name="deliveryFee"
                                    min="0">
                            </div>
                        </div>

                        <!-- Yandex Fee (if Yandex delivery) -->
                        <div class="col-md-6" *ngIf="selectedRequest.delivery_type === 'Yandex'">
                            <div class="form-group">
                                <label class="bmd-label-floating">Yandex To'lovi (UZS)</label>
                                <input type="number" class="form-control" [(ngModel)]="yandexFee" name="yandexFee"
                                    min="0">
                            </div>
                        </div>
                    </div>

                    <!-- Courier Details (if Own-Courier delivery) -->
                    <div class="row" *ngIf="selectedRequest.delivery_type === 'Own-Courier'">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="bmd-label-floating">Kuryer Ismi *</label>
                                <input type="text" class="form-control" [(ngModel)]="courierName" name="courierName"
                                    required>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="bmd-label-floating">Kuryer Telefoni *</label>
                                <input type="tel" class="form-control" [(ngModel)]="courierPhone" name="courierPhone"
                                    required>
                            </div>
                        </div>
                    </div>

                    <!-- Admin Notes -->
                    <div class="row">
                        <div class="col-md-8">
                            <div class="form-group">
                                <label class="bmd-label-floating">Admin Izohi</label>
                                <textarea class="form-control" [(ngModel)]="adminNotes" name="adminNotes" rows="3"
                                    placeholder="Yetkazish bo'yicha qo'shimcha ma'lumot"></textarea>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="bmd-label-floating">Tasdiqlovchi</label>
                                <input type="text" class="form-control" [(ngModel)]="processedBy" name="processedBy">
                            </div>
                        </div>
                    </div>
                </form>

            </div>
            <div class="modal-footer" style="flex-shrink: 0;">
                <button type="button" class="btn btn-secondary" (click)="closeModal()">Bekor qilish</button>
                <button type="button" class="btn btn-success" (click)="approveDeliveryRequest()"
                    [disabled]="processingRequest">
                    <span *ngIf="processingRequest" class="spinner-border spinner-border-sm mr-1"></span>
                    <i class="material-icons" *ngIf="!processingRequest">check</i>
                    Tasdiqlash va Yetkazish Yaratish
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Rejection Form Modal -->
<div class="modal" [class.show]="showRejectionForm" [style.display]="showRejectionForm ? 'block' : 'none'"
    style="z-index: 1050;" *ngIf="showRejectionForm">
    <div class="modal-dialog" style="max-height: 90vh; margin-top: 5vh;">
        <div class="modal-content" style="height: 70vh; display: flex; flex-direction: column;">
            <div class="modal-header" style="flex-shrink: 0;">
                <h5 class="modal-title">So'rovni Rad Etish - Mijoz: {{selectedRequest?.owner_id}}</h5>
                <button type="button" class="close" (click)="closeModal()">
                    <span>&times;</span>
                </button>
            </div>
            <div class="modal-body" style="flex: 1; overflow-y: auto; padding: 20px;" *ngIf="selectedRequest">

                <form>
                    <div class="form-group">
                        <label class="bmd-label-floating">Rad Etish Sababi *</label>
                        <textarea class="form-control" [(ngModel)]="rejectionReason" name="rejectionReason" rows="4"
                            placeholder="Nima uchun so'rov rad etilayotganini tushuntiring..." required></textarea>
                    </div>

                    <div class="form-group">
                        <label class="bmd-label-floating">Rad Etuvchi</label>
                        <input type="text" class="form-control" [(ngModel)]="processedBy" name="processedBy">
                    </div>
                </form>

            </div>
            <div class="modal-footer" style="flex-shrink: 0;">
                <button type="button" class="btn btn-secondary" (click)="closeModal()">Bekor qilish</button>
                <button type="button" class="btn btn-danger" (click)="rejectDeliveryRequest()"
                    [disabled]="processingRequest || !rejectionReason.trim()">
                    <span *ngIf="processingRequest" class="spinner-border spinner-border-sm mr-1"></span>
                    <i class="material-icons" *ngIf="!processingRequest">close</i>
                    Rad Etish
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal backdrop -->
<div class="modal-backdrop fade show"
    *ngIf="showRequestDetails || showApprovalForm || showRejectionForm || showFullImageModal" style="z-index: 1040;">
</div>